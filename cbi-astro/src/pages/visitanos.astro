---
import Layout from "../layouts/Layout.astro"
import { Image } from "astro:assets"
import serviciosDominicalImg from "../assets/serviciosDominical.JPG"
import aboutMyKidsImg from "../assets/aboutMyKids.jpeg"
import { address, serviceTimes } from "../constants.js"
import ServiceCard from "../components/services/ServiceCard.astro"
import { faqItems } from "../helpers/FAQ.js"
import ExpectSlider from "../components/visitanos/ExpectSlider.astro"
import ServiceSlider from "../components/visitanos/ServiceSlider.astro"
import { ArrowRight, ChevronDown } from "@lucide/astro"

// Google Maps URL
const mapsUrl = `https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(address)}`
---

<Layout title="Visíta CBI Orlando">
  <!-- Hero Section - Compact style inspired by cbi-theta -->
  <section class="relative h-[70vh] min-h-[500px] w-full overflow-hidden">
    <Image
      src={serviciosDominicalImg}
      alt="Servicio Dominical CBI Orlando"
      width={1920}
      height={1080}
      quality={85}
      class="absolute inset-0 w-full h-full object-cover"
      loading="eager"
    />
    <div
      class="absolute inset-0 bg-linear-to-b from-black/60 via-black/40 to-black/70">
    </div>

    <div
      class="relative z-10 h-full flex flex-col items-center justify-center text-center px-6">
      <span
        class="text-primary text-sm sm:text-base uppercase tracking-[0.3em] font-semibold mb-2 animate-fade-in">
        Visítanos
      </span>
      <h1
        class="font-bebas text-5xl sm:text-6xl md:text-7xl lg:text-8xl text-white mb-2 max-w-4xl leading-none animate-fade-in-up">
        Estamos Ansiosos Por <span class="text-primary">Conocerte!</span>
      </h1>
    </div>
  </section>

  <!-- Main Content -->
  <main class="bg-white">
    <section class="py-12 lg:py-24 px-6 lg:px-16">
      <h1
        class="text-4xl sm:text-5xl lg:text-6xl text-primary text-center leading-none">
        Nuestros Servicios
      </h1>
      <h4
        class="text-center text-gray-700 text-lg font-semibold max-w-xl mx-auto">
        Te esperamos todos los domingos! No vengas solo, tenemos un <span
          class="text-primary font-bold">espacio para ti y tu familia.</span
        >
      </h4>
      <div class="max-w-xl mx-auto mt-8">
        <ServiceCard
          day="Domingos"
          image={serviciosDominicalImg}
          name="CBI Orlando"
          times={serviceTimes[0].times}
          address={address}
          mapsLink={mapsUrl}
          imageAlt="Servicio Dominical CBI Orlando"
        />
      </div>
    </section>

    <ServiceSlider
      services={serviceTimes}
      image={serviciosDominicalImg}
      address={address}
      mapsUrl={mapsUrl}
    />

    <ExpectSlider />

    <!-- CBI Kids Section -->
    <section class="relative overflow-hidden bg-accent">
      <div class="max-w-7xl mx-auto">
        <div class="relative grid lg:grid-cols-2 min-h-[600px]">
          <!-- Background image for mobile, positioned element for desktop -->
          <div class="absolute inset-0 lg:relative lg:order-2 lg:min-h-full">
            <Image
              src={aboutMyKidsImg}
              alt="CBI Kids - Ministerio de niños"
              width={1000}
              height={900}
              quality={95}
              loading={"lazy"}
              class="absolute inset-0 w-full h-full object-cover object-[center_20%] md:object-top sm:object-top"
            />
            <!-- Dark overlay for mobile readability -->
            <div class="absolute inset-0 bg-accent/80 lg:bg-transparent"></div>
            <!-- Decorative gradient overlay for desktop -->
            <div
              class="absolute inset-0 bg-linear-to-r from-accent via-accent/20 to-transparent hidden lg:block">
            </div>
          </div>

          <!-- Text content -->
          <div
            class="relative z-10 flex flex-col justify-center px-8 lg:px-16 py-8 lg:py-16">
            <span
              class="text-primary text-sm uppercase tracking-[0.2em] font-semibold mb-4">
              ¿Qué hay para mis hijos?
            </span>
            <h2
              class="font-bebas text-4xl sm:text-5xl lg:text-6xl text-white leading-none mb-6">
              Un lugar para<br />
              <span class="text-primary">tus hijos</span>
            </h2>
            <p class="text-white/80 text-lg leading-relaxed mb-8 max-w-lg">
              No te preocupes, nosotros nos encargamos. Hay mucha diversión en
              <strong
                class="uppercase underline underline-offset-2 decoration-primary"
                ><span class="text-yellow-400">C</span><span
                  class="text-blue-500">B</span
                ><span class="text-green-500">I</span>
                <span class="text-red-500">K</span><span class="text-yellow-400"
                  >i</span
                ><span class="text-blue-500">d</span><span
                  class="text-green-500">s</span
                ></strong
              > donde cada semana, nuestros líderes invierten en la próxima generación,
              criando niños que aman a Dios y Su casa.
            </p>
            <a
              href="/kids"
              class="inline-flex items-center gap-3 bg-gray-300 text-black px-8 py-4 rounded-full ring-1 shadow-primary shadow-md ring-primary font-semibold text-lg hover:bg-gray-100 transition-all duration-300 group w-fit">
              <span>Conoce CBI Kids</span>
              <ArrowRight class="w-6 h-6" />
            </a>
          </div>
        </div>
      </div>
    </section>

    <!-- FAQ Section -->
    <section class="py-24 lg:py-32 px-6 lg:px-16 bg-gray-50">
      <div class="max-w-6xl mx-auto">
        <div class="grid lg:grid-cols-2 gap-12 lg:gap-16">
          <!-- Left Column - Title & Description (sticky on desktop) -->
          <div class="lg:sticky lg:top-32 lg:self-start">
            <h2
              class="font-bebas text-4xl sm:text-5xl lg:text-6xl text-gray-900 mb-4 leading-none">
              Preguntas<br />
              <span class="text-primary">más frecuentes</span>
            </h2>
            <p class="text-gray-500 text-lg max-w-md">
              Encuentra las preguntas más frecuentes y sus respuestas.
            </p>
          </div>

          <!-- Right Column - FAQ Accordion -->
          <div class="space-y-4" id="faq-accordion">
            {
              faqItems.map((item, index) => (
                <div
                  class="faq-item bg-white rounded-2xl overflow-hidden shadow-sm hover:shadow-md transition-shadow duration-300"
                  data-index={index}>
                  <button
                    class="faq-trigger w-full flex items-center justify-between p-6 text-left cursor-pointer group"
                    aria-expanded="false">
                    <h3 class="text-lg sm:text-xl font-semibold text-gray-900 group-hover:text-primary transition-colors pr-4">
                      {item.question}
                    </h3>
                    <div class="faq-icon w-10 h-10 rounded-full bg-gray-100 group-hover:bg-primary/10 flex items-center justify-center shrink-0 transition-all duration-300">
                      <ChevronDown
                        size={22}
                        class="faq-chevron text-gray-700 group-hover:text-primary transition-all duration-300"
                      />
                    </div>
                  </button>
                  <div class="faq-content max-h-0 overflow-hidden transition-all duration-300 ease-out">
                    <div class="px-6 pb-6">
                      <p class="text-gray-600 leading-relaxed">{item.answer}</p>
                    </div>
                  </div>
                </div>
              ))
            }
          </div>
        </div>
      </div>
    </section>

    <!-- CTA Section -->
    <section class="py-24 lg:py-32 px-6 lg:px-16 bg-gray-950">
      <div class="max-w-4xl mx-auto text-center">
        <h2 class="font-bebas text-4xl sm:text-5xl lg:text-6xl text-white mb-6">
          ¿Tienes más preguntas?
        </h2>
        <p class="text-xl text-gray-400 mb-10 max-w-2xl mx-auto">
          Estamos aquí para ayudarte. No dudes en contactarnos para más
          información.
        </p>
        <a
          href="/conectate"
          class="inline-flex items-center gap-3 bg-white text-gray-900 px-8 py-4 rounded-full font-semibold text-lg hover:bg-gray-100 transition-colors duration-300 group">
          <span>Contáctanos</span>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="20"
            height="20"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
            class="transform group-hover:translate-x-1 transition-transform duration-300">
            <path d="M5 12h14"></path>
            <path d="m12 5 7 7-7 7"></path>
          </svg>
        </a>
      </div>
    </section>
  </main>

  <script>
    const faqItems = document.querySelectorAll(".faq-item")

    faqItems.forEach((item) => {
      const trigger = item.querySelector(".faq-trigger")
      const content = item.querySelector(".faq-content")
      const chevron = item.querySelector(".faq-chevron")

      trigger?.addEventListener("click", () => {
        const isOpen = trigger.getAttribute("aria-expanded") === "true"

        // Close all other items
        faqItems.forEach((otherItem) => {
          if (otherItem !== item) {
            const otherTrigger = otherItem.querySelector(".faq-trigger")
            const otherContent = otherItem.querySelector(
              ".faq-content",
            ) as HTMLElement
            const otherChevron = otherItem.querySelector(".faq-chevron")

            otherTrigger?.setAttribute("aria-expanded", "false")
            if (otherContent) otherContent.style.maxHeight = "0"
            otherChevron?.classList.remove("rotate-180")
          }
        })

        // Toggle current item
        trigger.setAttribute("aria-expanded", (!isOpen).toString())

        if (content) {
          const contentEl = content as HTMLElement
          if (!isOpen) {
            contentEl.style.maxHeight = contentEl.scrollHeight + "px"
          } else {
            contentEl.style.maxHeight = "0"
          }
        }

        chevron?.classList.toggle("rotate-180")
      })
    })
  </script>

  <style>
    @keyframes fade-in {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }

    @keyframes fade-in-up {
      from {
        opacity: 0;
        transform: translateY(30px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .animate-fade-in {
      animation: fade-in 1s ease-out forwards;
    }

    .animate-fade-in-up {
      animation: fade-in-up 1s ease-out 0.2s forwards;
      opacity: 0;
    }
  </style>
</Layout>
